<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Libdnn by botonchou</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>Libdnn</h1>
        <p>C++ Library of Deep Neural Network</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/botonchou/libdnn" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/botonchou/libdnn/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/botonchou/libdnn/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <h1>
<a name="libdnn" class="anchor" href="#libdnn"><span class="octicon octicon-link"></span></a>libdnn</h1>

<p>C++ Library of Deep Neural Network</p>

<h1>
<a name="prerequisite" class="anchor" href="#prerequisite"><span class="octicon octicon-link"></span></a>Prerequisite</h1>

<p>You need</p>

<ul>
<li>A Graphic Processing Unit (GPU)</li>
<li>Linux / Ubuntu</li>
<li>Install <a href="https://developer.nvidia.com/cuda-toolkit">NVIDIA CUDA toolkit</a> (at least CUDA 5.0)</li>
</ul><h1>
<a name="quick-start" class="anchor" href="#quick-start"><span class="octicon octicon-link"></span></a>Quick Start</h1>

<ol>
<li><code>git clone https://github.com/botonchou/libdnn.git &amp;&amp; cd libdnn &amp;&amp; ./install-sh</code></li>
<li><code>cd example/</code></li>
<li>
<code>dnn-init data/a1a --nodes 512-512</code> ( Please enter 2 )</li>
<li><code>dnn-train data/a1a --pre 2 -f a1a.model --min-acc 0.8</code></li>
<li><code>dnn-predict data/a1a.t a1a.model</code></li>
</ol><h1>
<a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Examples</h1>

<p>There're 3 examples in example/:</p>

<ul>
<li>example1.sh</li>
<li>example2.sh</li>
<li>example3.sh</li>
</ul><p>You can run all of them by <code>./go_all.sh</code></p>

<h1>
<a name="how-to-install-" class="anchor" href="#how-to-install-"><span class="octicon octicon-link"></span></a>How to Install ?</h1>

<div class="highlight highlight-bash"><pre>git clone https://github.com/botonchou/libdnn.git
<span class="nb">cd </span>libdnn/
./install-sh
</pre></div>

<h1>
<a name="tutorial" class="anchor" href="#tutorial"><span class="octicon octicon-link"></span></a>Tutorial</h1>

<p>Libdnn aims to an easy quick machine learning using <strong>deep neural network</strong>.</p>

<h3>
<a name="prepare-your-data" class="anchor" href="#prepare-your-data"><span class="octicon octicon-link"></span></a>Prepare your data</h3>

<h4>
<a name="training-data-and-testing-data" class="anchor" href="#training-data-and-testing-data"><span class="octicon octicon-link"></span></a>Training data and testing data</h4>

<p>You need at least two data files, one with labels (called training data) and the other with/without labels (called testing data.)</p>

<p>If you just want to mess around but without data at hand, you can download some from the <a href="http://www.csie.ntu.edu.tw/%7Ecjlin/libsvmtools/datasets/">LibSVM website</a>. </p>

<h4>
<a name="data-format" class="anchor" href="#data-format"><span class="octicon octicon-link"></span></a>Data Format</h4>

<p>The data can be provided either in the LIBSVM format or the dense format.</p>

<h5>
<a name="libsvm-format" class="anchor" href="#libsvm-format"><span class="octicon octicon-link"></span></a>LIBSVM format:</h5>

<pre><code>-1 5:1 6:1 15:1 22:1 36:1 42:1
+1 3:1 6:1 17:1 19:1 39:1 42:1
-1 5:1 7:1 14:1 22:1 36:1 40:1
-1 1:1 6:1 17:1 22:1 36:1 42:1
+1 4:1 6:1 14:1 29:1 39:1 42:1
-1 3:1 6:1 15:1 22:1 36:1 42:1
+1 5:1 6:1 15:1 22:1 36:1 40:1
</code></pre>

<p>Each row is one feature vector. In this case, 7 rows means 7 feature vector (i.e. 7 training data.)
The first column of each row are the labels, and the rest are feature vectors in the sparse format. Take the first row for example:</p>

<pre><code>-1 5:1 6:1 15:1 22:1 36:1 42:1
</code></pre>

<p><strong>-1</strong> is the label. The n:x format means the value of n-th dimension of this vector is x. In this example, it's a vector consists most of 0 with only few exceptions at 5, 6, 15, 22, 36, 42.</p>

<h5>
<a name="dense-format" class="anchor" href="#dense-format"><span class="octicon octicon-link"></span></a>Dense format:</h5>

<pre><code>-1 0 0 0 0 1 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1
+1 0 0 1 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1
-1 0 0 0 0 1 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0
-1 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1
+1 0 0 0 1 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 1
-1 0 0 1 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1
+1 0 0 0 0 1 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0
</code></pre>

<p>(this is the same data as the above)</p>

<h2>
<a name="how-to-use-" class="anchor" href="#how-to-use-"><span class="octicon octicon-link"></span></a>How to Use ?</h2>

<p>There're 3 programs, dnn-init, dnn-train, dnn-predict.</p>

<h3>
<a name="dnn-init" class="anchor" href="#dnn-init"><span class="octicon octicon-link"></span></a>dnn-init</h3>

<pre><code>dnn-init [options] training_data [model_out]
</code></pre>

<p>This program performs a model initialization using stacked Restricted Boltzmann Machine (stacked RBM). For example:</p>

<pre><code>dnn-init --nodes 1024-1024 train.dat
</code></pre>

<p>The program will first ask you for the number of target classes (i.e. the number of nodes in output layer, <strong>Dout</strong>). Also, it'll found the dimension of input feature vector (<strong>Din</strong>) from <em>train.dat</em>. 
It then perform stacked RBM initialization for a neural network of the structure:</p>

<pre><code>Din-1024-1024-Dout
</code></pre>

<p>(<strong>Note</strong>: If the values in train.dat does not lie in the range <strong>[0, 1]</strong>, it would cause an assertion. Try to add <code>--rescale true</code> after <code>dnn-init</code> like: <code>dnn-init --rescale true --nodes 1024-1024 train.dat</code>.)</p>

<h3>
<a name="dnn-train" class="anchor" href="#dnn-train"><span class="octicon octicon-link"></span></a>dnn-train</h3>

<pre><code>dnn-train [options] training_data [model_out]
</code></pre>

<p>This program perform mini-batch stochastic gradient descent (mini-batch SGD) to train the model initialized by <code>dnn-init</code>.</p>

<pre><code>dnn-train train.dat --pre 2 -f train.dat.model
</code></pre>

<h3>
<a name="dnn-predict" class="anchor" href="#dnn-predict"><span class="octicon octicon-link"></span></a>dnn-predict</h3>

<pre><code>dnn-predict testing_data model_in [predict_out]
</code></pre>

<p>For example:</p>

<pre><code>dnn-predict test.dat train.dat.model
</code></pre>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/botonchou">botonchou</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>